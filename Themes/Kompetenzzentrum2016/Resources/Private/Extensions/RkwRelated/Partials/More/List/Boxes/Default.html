{namespace rkw=RKW\RkwRelated\ViewHelpers}
<div class="box-wrapper">
	<f:link.page pageUid="{pages.uid}" class="box {pages.txRkwbasicsDepartment.cssClass} big" target="{f:if(condition: '{settingsArray.openLinksInSameWindow}', then: '', else: '_blank')}" title="{pages.title}">
		<header>
			<p>
                <f:if condition="<rkw:pageTranslateProperty pageUid='{pages.uid}' dbField='title' sysLanguageUid='{sysLanguageUid}' />">
                    <f:then>
                        <f:format.crop maxCharacters="{settingsArray.headerCrop}" respectWordBoundaries="false"><rkw:pageTranslateProperty pageUid='{pages.uid}' dbField='title' sysLanguageUid='{sysLanguageUid}' /></f:format.crop>
                    </f:then>
                    <f:else>
                        <f:format.crop maxCharacters="{settingsArray.headerCrop}" respectWordBoundaries="false">{pages.title}</f:format.crop>
                    </f:else>
                </f:if>
			</p>
		</header>
		<f:if condition="{pages.txRkwbasicsTeaserImage}" >
			<f:then>
				<div class="box-content wysiwyg">
					<figure>
						<f:cObject typoscriptObjectPath="plugin.tx_rkwrelated.libs.responsiveImageThumbnail" data="{pages.txRkwbasicsTeaserImage.uid}"/>
					</figure>
					<f:if condition="{settingsArray.showDate}">
						<p class="event-date">
							<f:if condition="{settingsArray.useRkwSearchForSorting}">
								<f:then>
                                    <f:if condition="{pages.txRkwsearchPubdate}">
                                        <f:then>
                                            <f:format.date format="d.m.Y">{pages.txRkwsearchPubdate}</f:format.date>
                                        </f:then>
                                        <f:else>
                                            <f:format.date format="d.m.Y">{pages.lastUpdated}</f:format.date>
                                        </f:else>
                                    </f:if>
								</f:then>
								<f:else>
									<f:format.date format="d.m.Y">{pages.lastUpdated}</f:format.date>
								</f:else>
							</f:if>
						</p>
					</f:if>
				</div>
			</f:then>
			<f:else>
				<div class="box-content">
					<div class="wysiwyg">
						<p>
                            <f:if condition="<rkw:pageTranslateProperty pageUid='{pages.uid}' dbField='txRkwbasicsTeaserText' sysLanguageUid='{sysLanguageUid}' />">
                                <f:then>
                                    <f:format.crop maxCharacters="{settingsArray.contentCrop}" respectWordBoundaries="false"><rkw:pageTranslateProperty pageUid='{pages.uid}' dbField='txRkwbasicsTeaserText' sysLanguageUid='{sysLanguageUid}' /></f:format.crop>
                                </f:then>
                                <f:else>
                                    <f:format.crop maxCharacters="{settingsArray.contentCrop}" respectWordBoundaries="false">{pages.txRkwbasicsTeaserText}</f:format.crop>
                                </f:else>
                            </f:if>
						</p>
					</div>
                    <f:if condition="{settingsArray.showDate}">
                        <p class="event-date">
                            <f:if condition="{pages.txRkwsearchPubdate}">
                                <f:then>
                                    <f:format.date format="d.m.Y">{pages.txRkwsearchPubdate}</f:format.date>
                                </f:then>
                                <f:else>
                                    <f:format.date format="d.m.Y">{pages.tstamp}</f:format.date>
                                </f:else>
                            </f:if>
                        </p>
                    </f:if>
				</div>
			</f:else>
		</f:if>

		<footer>
			<p class="icon-article">
				<f:format.crop maxCharacters="{settingsArray.footerCrop}" respectWordBoundaries="false">{pages.txRkwbasicsDocumentType.name}</f:format.crop>
			</p>
		</footer>
	</f:link.page>
</div>

